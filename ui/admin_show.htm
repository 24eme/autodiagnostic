<div id="administration-title">
  <div class="p-5">
    <div class="container-fluid">
      <h1 class="text-center display-5 fw-bold"><i class="bi bi-question"></i> RÃ©ponses</h1>
    </div>
  </div>
</div>

<div id="reponses-liste" class="container">
  <set total="0" total_cat="0"/>
  <table class="table table-striped">
    <repeat group="{{ @questions->getQuestionnaire() }}" key="{{ @categorie }}" value="{{ @questions_categorie }}" counter="{{ @ctr }}">
      <check if="{{ @ctr !== 1 }}">
        <tr>
          <th colspan="2">Total</th>
          <th class="text-end pe-0">{{ @total }}&nbsp;<small>pts</small></th>
          <th class="text-end text-muted">/&nbsp;{{ @total_cat }}&nbsp;<small>pts</small></th>
        </tr>
        <set total="0" total_cat="0"/>
      </check>
      <repeat group="{{ @questions_categorie }}" value="{{ @question }}">
        <check if="{{ @question.type === 'categorie' }}">
        <true>
          <set total_cat="{{ @statistiques->getHighScores()[@questions->getQuestionCategorie(@categorie)] ?: 0 }}" />
          <tr>
            <th colspan=4 class="text-start" style="background-color: {{ @question.couleur }}; color: {{ @question.couleur_texte }}">{{ @question.libelle }}</td>
          </th>
        </true>
        <false>
          <tr>
            <td title="{{ @question.id }}">{{ @questions->getQuestionPosition(@question.id) }}. {{ @question.libelle }} <a href="/_config#modal-{{ @categorie }}-{{ @question.id }}" class="text-dark"><i class="bi-eye"></i></a></td>
            <td>{{ @reponse->get(@question.id)['reponse'] }} <small class="text-muted">{{ @question.unite }}</small></td>
            <check if="{{ @question.notation }}">
            <true>
              <td class="text-end pe-0">{{ @statistiques->getNotation(@question)['score'] }}&nbsp;<small>pts</small>
              </td>
              <td class="text-end text-muted">/&nbsp;{{ @statistiques->getNotation(@question)['highScore'] }}&nbsp;<small>pts</small></td>
              <set total="{{ @total += @statistiques->getNotation(@question)['score'] }}" />
            </true>
            <false><td></td><td></td></false>
            </check>
          </tr>
        </false>
        </check>
      </repeat>
    </repeat>
    <tr>
      <th colspan="2">Total</th>
      <th class="text-end pe-0">{{ @total }}&nbsp;<small>pts</small></th>
      <th class="text-end text-muted">/&nbsp;{{ @total_cat }}&nbsp;<small>pts</small></th>
    </tr>
  </table>
</div>
